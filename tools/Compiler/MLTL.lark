//// Parser Rules

program: block*

block: var_block
     | def_block
     | spec_block
     | order_block

var_block: KW_VAR var_list
var_list: (IDENTIFIER ":" type ";")+ 

type: BASE_TYPE
    | KW_SET set_param

set_param: "<" BASE_TYPE ">"
         | "âŸ¨" BASE_TYPE "âŸ©"

def_block: KW_DEF def_list
def_list: (IDENTIFIER "=" expr ";")+

spec_block: KW_SPEC spec_list
spec_list: (spec_label? expr ";")+
spec_label: IDENTIFIER ":"

order_block: KW_ORDER order_list
order_list: IDENTIFIER ("," IDENTIFIER)* ";"

expr: expr "?" expr ":" expr
    | expr LOG_OR expr
    | expr LOG_AND expr
    | expr BW_OR expr
    | expr BW_XOR expr
    | expr BW_AND expr
    | expr REL_OP expr
    | expr ARITH_ADD_OP expr
    | expr ARITH_MUL_OP expr
    | expr TL_BIN_OP interval expr
    | UNARY_OP expr 
    | TL_UNARY_OP interval expr 
    | IDENTIFIER "(" expr ")"
    | "(" expr ")"
    | NUMBER
    | LOG_LIT
    | IDENTIFIER

interval: "[" INT ("," INT)? "]"

//// Lexical Spec

// Types
BASE_TYPE: "bool"
         | "int"
         | "float"

// Op groups for precedence
UNARY_OP: LOG_NEG | BW_NEG 
TL_UNARY_OP: TL_GLOBALLY | TL_FUTURE | TL_SINCE | TL_ONCE 
TL_BIN_OP: TL_UNTIL | TL_RELEASE | TL_HISTORICALLY
REL_OP: REL_EQ | REL_NEQ | REL_GT 
      | REL_GTE | REL_LT | REL_LTE
ARITH_ADD_OP: ARITH_ADD | ARITH_SUB
ARITH_MUL_OP: ARITH_MUL | ARITH_DIV | ARITH_MOD

// Propositional logic ops/literals
LOG_NEG: "!" | "Â¬" 
LOG_AND: "&&" | "âˆ¨"
LOG_OR: "||" | "âˆ§"
LOG_XOR: "XOR" | "âŠ•"
LOG_IMPL: "->" | "â†’"
LOG_IFF: "<->" | "â†”" 
LOG_LIT: TRUE | FALSE
TRUE: "TRUE" | "true" | "âŠ¤"
FALSE: "FALSE" | "false" | "âŠ¥"

// Bitwise ops
BW_NEG: "~"
BW_AND: "&"
BW_OR: "|"
BW_XOR: "^"

// Relational ops
REL_EQ: "=="
REL_NEQ: "!=" | "â‰ "
REL_GT: ">"
REL_GTE: ">=" | "â‰¥"
REL_LT: "<"
REL_LTE: "<=" | "â‰¤" 

// Arithmetic ops
ARITH_ADD: "+"
ARITH_SUB: "-"
ARITH_MUL: "*" | "â€¢" | "â‹…"
ARITH_DIV: "/" | "Ã·"
ARITH_MOD: "MOD" | "%"
ARITH_POW: "**"
ARITH_SQRT: "SQRT" | "âˆš"
ARITH_PM: "+-" | "Â±"

// Temporal ops
TL_GLOBALLY: "G" | "ð“–" | "â–¡"
TL_FUTURE: "F" | "ð“•" | "â‹„" | "â™¢"
TL_NEXT: "X" | "â—‹"
TL_SINCE: "S" | "ð“¢"
TL_ONCE: "O" | "ð“ž"
TL_UNTIL: "U" | "ð“¤"
TL_RELEASE: "R" | "ð“¡"
TL_HISTORICALLY: "H" | "ð“—"

// First-order -- not used
FO_FORALL: "FORALL" | "âˆ€"
FO_EXISTS: "EXISTS" | "âˆƒ"

// Set-wise ops -- not used
SW_EMPTY_SET: "âˆ…"
SW_MEMBER: "IN" | "âˆˆ"
SW_SUBSET: "SUBSET" | "âŠ‚"
SW_SUBSETEQ: "SUBSETEQ" | "âŠ†"
SW_SUPSET: "SUPSET" | "âŠ‚"
SW_SUPSETEQ: "SUPSETEQ" | "âŠ‡"
SW_SUM: "SUM" | "âˆ‘"
SW_PROD: "PROD" | "âˆ"
SW_UNION: "SETUNION" | "â‹ƒ"
SW_INTERSECTION: "SETINTERSECTION" | "â‹‚"
SW_AND: "SETAND" | "â‹€"
SW_OR: "SETOR" | "â‹"
SW_CTPROD: "CTPROD" | "Ã—" 

// Keywords
KW_VAR: "VAR"
KW_DEF: "DEF"
KW_SPEC: "SPEC"
KW_ORDER: "ORDER"
KW_SET: "SET"

// Identifiers
IDENTIFIER: CNAME ("â‚".."â‚“")?
          | "Î‘".."Ï‰"

%import common.NUMBER
%import common.INT
%import common.CNAME
%import common.SH_COMMENT
%import common.WS

%ignore SH_COMMENT
%ignore WS